!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.TableLibrary=e():t.TableLibrary=e()}(this,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:String(e)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.createElement(t);return Array.isArray(e)&&e.forEach((function(t){n.classList.add(t)})),n}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=document.createElementNS("http://www.w3.org/2000/svg",t);return Array.isArray(e)&&e.forEach((function(t){n.classList.add(t)})),n}function l(t,e){return t?e?void t.appendChild(e):"Элемент не валиден":"Контейнер не валиден"}t.r(e),t.d(e,{Chart:()=>v,Modal:()=>d,Table:()=>b});var c,u,d=function(){function t(e){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"basicIdContent",a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n(this,t),c.add(this),this.destroyMode=a,function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,c,"m",u).call(this),this.modal=s("div",["modal"]);var o=s("span",["close-btn"]);o.innerHTML="&times;",o.addEventListener("click",(function(){return r.closeModal()})),this.modalContent=s("div",["modal-content"]),this.modalContent.id=i,"string"==typeof e?this.modalContent.innerHTML=e:e&&l(this.modalContent,e),this.overlay=s("div",["overlay"]),this.overlay.addEventListener("click",(function(){return r.closeModal()})),l(this.modal,o),l(this.modal,this.modalContent),l(document.body,this.modal),l(document.body,this.overlay)}return o(t,[{key:"openModal",value:function(){document.body.style.overflow="hidden",this.modal.style.display="block",this.overlay.style.display="block"}},{key:"closeModal",value:function(){document.body.style.overflow="initial",this.modal.style.display="none",this.overlay.style.display="none",this.destroyMode&&(this.modal.remove(),this.overlay.remove())}},{key:"setBackGroundColorModal",value:function(t){this.modal.style.backgroundColor=t}},{key:"setBackGroundColorOverlay",value:function(t){this.overlay.style.backgroundColor=t}},{key:"setMaxWidth",value:function(t){this.modal.style.maxWidth=t}},{key:"setMaxHeight",value:function(t){this.modal.style.maxHeight=t}}]),t}();function y(t){var e=s("h2");e.style.color="red",Array.isArray(t)?t.forEach((function(t){console.log(t),e.innerHTML+="".concat(t,"<br>")})):e.innerHTML=t,new d(e,"error-modal-content",!0).openModal()}c=new WeakSet,u=function(){var t=s("style",["modalStyle"]);t.innerHTML="\n        body {\n          margin: 0;\n          padding: 0;\n          box-sizing: border-box;\n          height: 100vh;\n        }\n    \n        .modal {\n          display: none;\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          padding: 15px;\n          background-color: #fff;\n          box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);\n          border-radius: 5px;\n          z-index: 999;\n          overflow-y: auto;\n          max-height: 80%;\n          max-width: 80%;\n        }\n    \n        .overlay {\n          display: none;\n          position: fixed;\n          top: 0;\n          left: 0;\n          width: 100%;\n          height: 100%;\n          background-color: rgba(0, 0, 0, 0.5);\n          z-index: 998;\n        }\n    \n        .modal-content {\n            overflow-y: auto;\n            word-wrap: break-word;\n        }\n    \n        .close-btn {\n          position: absolute;\n          top: 10px;\n          right: 10px;\n          cursor: pointer;\n        }\n      ",document.head.querySelector(".modalStyle")||l(document.head,t)};var f=function(){function t(){n(this,t)}return o(t,[{key:"subscribe",value:function(t,e){var n=this;return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),{unsubscribe:function(){n.listeners[t]=n.listeners[t].filter((function(t){return t!==e}))}}}},{key:"next",value:function(t,e){this.listeners[t]&&this.listeners[t].forEach((function(t){t(e)}))}},{key:"unsubscribeAll",value:function(){this.listeners={}}}]),t}(),b=function(){function t(e,r){var i=this;n(this,t),this.cellChange=function(t){var e=t.target,n=Array.from(e.parentNode.children),r=Array.from(e.parentNode.parentNode.children),a=n.indexOf(e),o=r.indexOf(e.parentNode);e.textContent!==i.tableData.body[o][a]&&(i.tableData.body[o][a]=e.textContent,document.activeElement===e&&e.blur(),console.log("x:".concat(a+1,",y:").concat(o+1,", content: ").concat(e.textContent)),i.triggerEvent("changeCellContent",{x:a+1,y:o+1,newContent:e.textContent}))},this.listenChangeCellOnKey=function(t){"Enter"===t.key&&(t.preventDefault(),i.cellChange(t),t.target.blur())},this.responseValid=this.validate(e,r),this.responseValid&&(this.id=e,this.tableData=r,this.containerElement=document.getElementById(e),this.renderMain(),this.createStyles(),this.observable=new f)}return o(t,[{key:"validate",value:function(t,e){return t&&document.getElementById(t)?e.header&&0!==e.header.length?e.body&&0!==e.body.length?e.footer?!!((r=(n=e).header.length)>0&&n.body.every((function(t){return t.length===r})))||(y("Неверный формат даты. Укажите действительные данные таблицы."),!1):(y("Неверный нижний колонтитул. Укажите действительную строку."),!1):(y("Недействительное тело таблицы. Укажите непустой массив."),!1):(y("Неверный заголовок таблицы. Укажите непустой массив."),!1):(y("Неверный ID. Укажите действительный идентификатор строки."),!1);var n,r}},{key:"renderMain",value:function(){this.tableElement=s("table",["myTable"]);var t=s("thead"),e=s("tbody");l(this.tableElement,t),l(this.tableElement,e),this.theadElement=t,this.tbodyElement=e,this.renderHeader(),this.renderBody(),this.renderFooter(),l(this.containerElement,this.tableElement)}},{key:"renderHeader",value:function(){var t=s("tr",["headerTable"]);this.tableData.header.forEach((function(e){var n=s("th");n.textContent=e,l(t,n)})),l(this.theadElement,t)}},{key:"renderBody",value:function(){var t=this;this.tableData.body.forEach((function(e,n){var r=s("tr");t.tableData.body[n].forEach((function(e,i){var a=s("td");a.textContent=t.tableData.body[n][i],a.contentEditable="true",a.onblur=t.cellChange,a.onmouseout=t.cellChange,a.onkeydown=t.listenChangeCellOnKey,l(r,a)})),l(t.tbodyElement,r)}))}},{key:"renderFooter",value:function(){if(this.tableData.footer){var t=s("tfoot");this.tFooterElement=t;var e=s("td",["footerTable"]);e.textContent=this.tableData.footer,l(t,e),l(this.tableElement,t)}}},{key:"createStyles",value:function(){var t=s("style",["tableStyle"]);document.head.querySelector(".tableStyle")||(t.className="tableStyle",t.innerHTML="\n          *{\n            box-sizing: border-box;\n          }\n          .myTable {\n            width: 100%;\n            border-collapse: collapse;\n            table-layout: fixed;\n          }\n          .footerTable {\n            background-color: rgba(128, 128, 128, 0.1);\n          }\n          .myTable td, .myTable th {\n            padding: 0 20px;\n            height: 40px;\n            border: 1px solid black;\n          }\n        ",l(document.head,t))}},{key:"pushRow",value:function(){this.responseValid&&this.insertRow(this.tableData.body.length+1)}},{key:"pushColumn",value:function(t){t?this.insertColumn(this.tableData.header.length+1,t):y("Не передан header")}},{key:"insertRow",value:function(t){if(this.responseValid)if(+t&&t>=0&&(this.tableData.body[t-1]||t===this.tableData.body.length+1)){var e=[];this.tableData.header.forEach((function(){return e.push("")})),this.tableData.body.splice(t-1,0,e),this.tbodyElement.innerHTML="",this.renderBody(),this.triggerEvent("addRow",{y:t})}else y("Не корректные координаты для вставки ряда")}},{key:"insertColumn",value:function(t,e){var n=this;this.responseValid&&(+t&&t>=0&&e&&this.tableData.header[t-1]||t===this.tableData.header.length+1?(this.tableData.header.splice(t-1,0,e),this.tableData.body.forEach((function(e,r){return n.tableData.body[r].splice(t-1,0,"")})),this.tbodyElement.innerHTML="",this.theadElement.innerHTML="",this.renderHeader(),this.renderBody(),this.triggerEvent("addColumn",{x:t})):y("Не корректные координаты для вставки колонки, или не передан header"))}},{key:"deleteRow",value:function(t){this.responseValid&&(+t&&t>0&&this.tableData.body.length>=t&&this.tableData.body[t-1]?(this.tableData.body.splice(t-1,1),this.tbodyElement.innerHTML="",this.renderBody(),this.triggerEvent("removeRow",{y:t})):y("Не корректные координаты для удаление ряда"))}},{key:"deleteColumn",value:function(t){var e=this;this.responseValid&&(+t&&t>0&&this.tableData.header[t-1]?(this.tableData.header.splice(t-1,1),this.tableData.body.forEach((function(n,r){return e.tableData.body[r].splice(t-1,1)})),this.tbodyElement.innerHTML="",this.theadElement.innerHTML="",this.renderHeader(),this.renderBody(),this.triggerEvent("removeColumn",{x:t})):y("Не корректные координаты для удаление колонки"))}},{key:"getChartData",value:function(t){if(this.responseValid&&this.tableData.body[t-1]){var e=!1,n=[];if(this.tableData.body[t-1].forEach((function(r,i){+r||(e=!0,n.push("В ячейке y:".concat(t," x:").concat([i+1]," не число")))})),!e)return{data:this.tableData.body[t-1].map((function(t){return+t?+t:0})),header:this.tableData.header};y(n)}}},{key:"setTable",value:function(t){var e=this.validate(this.id,t);this.responseValid&&e&&JSON.stringify(t)!==JSON.stringify(this.tableData)&&(this.tableData=t,this.theadElement.innerHTML="",this.tbodyElement.innerHTML="",this.tFooterElement.innerHTML="",this.renderHeader(),this.renderBody(),this.renderFooter(),this.triggerEvent("setTable",this.tableData))}},{key:"subscribe",value:function(t,e){return this.observable.subscribe(t,e)}},{key:"triggerEvent",value:function(t,e){this.observable.next(t,e)}}]),t}(),v=function(){function t(e,r,i,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"line";n(this,t),this.containerId=e,this.chartData=r,this.headerData=i,this.size=a,this.chartType=o,this.markCount=10,this.markColor="a0a0a0",this.markWidth=.1,this.markTextColor="rgba(53, 53, 53, 0.9)",this.lineColor="rgb(69, 97, 255)",this.lineWidth=1,this.circleColor="blue",this.circleRadius=3,this.columnColor="rgba(53, 53, 53, 0.575)",this.columnBorder="0.5px solid rgba(53, 53, 53, 0.9)",this.createStyles(),this.renderBase(),this.setChartType(this.chartType)}return o(t,[{key:"renderBase",value:function(){this.container=document.getElementById(this.containerId),this.chartContainer=s("div",["containerChart"]),this.setContainerSize(),l(this.container,this.chartContainer)}},{key:"setContainerSize",value:function(){this.chartContainer.style.width=this.size.width+"px",this.chartContainer.style.height=this.size.height+"px"}},{key:"renderSvg",value:function(){var t=h("svg");t.setAttribute("width","".concat(this.size.width)),t.setAttribute("height","".concat(this.size.height)),l(this.chartContainer,t),this.svgContainer=t}},{key:"renderColumnChart",value:function(){var t=this;this.chartColumnContainer=s("div",["columnContainer"]),l(this.chartContainer,this.chartColumnContainer),this.renderMarks(),this.chartData.forEach((function(e){var n=s("div");n.style.height=t.size.height/t.findMaxNumberInArray(t.chartData)*e+"px",n.style.width=t.size.width/t.chartData.length+"px",n.style.background=t.columnColor,n.style.border=t.columnBorder,l(t.chartColumnContainer,n)}))}},{key:"renderLineChart",value:function(){var t=this;this.svgLineContainer||(this.svgLineContainer=h("g",["svgLineContainer"]),l(this.svgContainer,this.svgLineContainer)),this.svgContainer.getAttribute("xmlns")||(this.svgContainer.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.svgContainer.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink")),this.chartData.forEach((function(e,n){var r=t.size.width/(t.chartData.length-1)*n,i=t.size.height-t.size.height/(t.findMaxNumberInArray(t.chartData)-t.findMinNumberInArray(t.chartData))*(e-t.findMinNumberInArray(t.chartData)),a=n+1<t.chartData.length?t.size.width/(t.chartData.length-1)*(n+1):0,o=n+1<t.chartData.length?t.size.height-t.size.height/(t.findMaxNumberInArray(t.chartData)-t.findMinNumberInArray(t.chartData))*(t.chartData[n+1]-t.findMinNumberInArray(t.chartData)):0,s=h("line");s.setAttribute("x1","".concat(r)),s.setAttribute("y1","".concat(i)),s.setAttribute("x2","".concat(a)),s.setAttribute("y2","".concat(o)),s.setAttribute("stroke",t.lineColor),s.setAttribute("stroke-width","".concat(t.lineWidth));var c=h("circle");c.setAttribute("cx","".concat(r)),c.setAttribute("cy","".concat(i)),c.setAttribute("r","".concat(t.circleRadius)),c.setAttribute("fill",t.circleColor),n+1<t.chartData.length&&l(t.svgLineContainer,s),l(t.svgLineContainer,c)})),this.svgMarksContainer||this.renderMarks()}},{key:"renderMarks",value:function(){this.svgMarksContainer||(this.svgMarksContainer=h("g",["svgMarksContainer"]),l(this.svgContainer,this.svgMarksContainer));for(var t=0;t<=this.markCount;t++){var e=this.size.height-this.size.height/this.markCount*t,n=this.size.width,r=this.size.height-this.size.height/this.markCount*t,i=h("line");i.setAttribute("x1","".concat(0)),i.setAttribute("y1","".concat(e)),i.setAttribute("x2","".concat(n)),i.setAttribute("y2","".concat(r)),i.setAttribute("stroke",this.markColor),i.setAttribute("stroke-width","".concat(this.markWidth)),l(this.svgMarksContainer,i)}this.renderXAxis(),this.renderYAxis()}},{key:"renderXAxis",value:function(){var t=this;this.chartData.forEach((function(e,n){var r=t.size.width/(t.chartData.length-1)*n-10,i=t.size.height+25,a=h("text");a.setAttribute("x","".concat(r)),a.setAttribute("y","".concat(i)),a.setAttribute("font-size","15px"),a.setAttribute("fill",t.markTextColor),a.textContent=t.headerData[n],l(t.svgMarksContainer,a)}))}},{key:"renderYAxis",value:function(){for(var t=this.findMinNumberInArray(this.chartData),e=this.findMaxNumberInArray(this.chartData),n=0;n<=this.markCount;n++){var r=this.size.height-this.size.height/this.markCount*n+5,i=Math.round(100*((e-t)/this.markCount*n+t))/100,a=h("text");a.setAttribute("x","".concat(-30)),a.setAttribute("y","".concat(r)),a.setAttribute("font-size","15px"),a.setAttribute("fill",this.markTextColor),a.textContent=i.toString(),l(this.svgMarksContainer,a)}}},{key:"createStyles",value:function(){var t=s("style",["chartStyle"]);document.head.querySelector(".chartStyle")||(t.className="tableStyle",t.innerHTML="\n          .containerChart{\n            padding: 20px 20px 25px 35px;\n          }\n          .containerChart svg{\n            overflow: visible;\n            position: absolute;\n          }\n          .containerChart .columnContainer{\n            display: flex;\n            align-items: flex-end;\n          }\n        ",l(document.head,t))}},{key:"findMaxNumberInArray",value:function(t){if(0===t.length)return null;for(var e=t[0],n=1;n<t.length;n++)t[n]>e&&(e=t[n]);return e}},{key:"findMinNumberInArray",value:function(t){if(0===t.length)return null;for(var e=t[0],n=1;n<t.length;n++)t[n]<e&&(e=t[n]);return e}},{key:"setChartType",value:function(t){"line"===t?(this.chartContainer.innerHTML="",this.svgMarksContainer=null,this.svgLineContainer=null,this.renderSvg(),this.renderLineChart()):"column"===t&&(this.chartContainer.innerHTML="",this.svgMarksContainer=null,this.svgLineContainer=null,this.renderSvg(),this.renderColumnChart())}},{key:"setChartData",value:function(t,e){Array.isArray(t)&&t.length>=2?(this.headerData=e,this.chartData=t,this.chartContainer.innerHTML="",this.setChartType(this.chartType)):y("Неверные данные диаграммы. Пожалуйста, предоставьте массив данных.")}},{key:"setMarkColor",value:function(t){var e=this;if(this.markColor=t,this.svgMarksContainer){var n=Array.from(this.svgMarksContainer.children).filter((function(t){return"line"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("stroke",e.markColor)}))}}},{key:"setMarkCount",value:function(t){"number"==typeof t&&t>2?(this.markCount=t,this.svgMarksContainer.remove(),this.svgMarksContainer=null,this.renderMarks()):y("Недопустимое значение счетчика. Укажите число, большее или равное 2.")}},{key:"setMarkWidth",value:function(t){var e=this;if(this.markWidth=t,this.svgMarksContainer){var n=Array.from(this.svgMarksContainer.children).filter((function(t){return"line"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("stroke-width","".concat(e.markWidth))}))}}},{key:"setMarkTextColor",value:function(t){var e=this;if(this.markTextColor=t,this.svgMarksContainer){var n=Array.from(this.svgMarksContainer.children).filter((function(t){return"text"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("fill",e.markTextColor)}))}}},{key:"setLineColor",value:function(t){var e=this;if(this.lineColor=t,this.svgLineContainer){var n=Array.from(this.svgLineContainer.children).filter((function(t){return"line"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("stroke",e.lineColor)}))}}},{key:"setLineWidth",value:function(t){var e=this;if(this.lineWidth=t,this.svgLineContainer){var n=Array.from(this.svgLineContainer.children).filter((function(t){return"line"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("stroke-width","".concat(e.lineWidth))}))}}},{key:"setCircleColor",value:function(t){var e=this;if(this.circleColor=t,this.svgLineContainer){var n=Array.from(this.svgLineContainer.children).filter((function(t){return"circle"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("fill",e.circleColor)}))}}},{key:"setCircleRadius",value:function(t){var e=this;if(this.circleRadius=t,this.svgLineContainer){var n=Array.from(this.svgLineContainer.children).filter((function(t){return"circle"===t.tagName}));n.length>0&&n.forEach((function(t){t.setAttribute("r","".concat(e.circleRadius))}))}}},{key:"setColumnColor",value:function(t){var e=this;if(this.columnColor=t,this.chartColumnContainer){var n=Array.from(this.chartColumnContainer.children);n.length>0&&n.forEach((function(t){t.style.backgroundColor=e.columnColor}))}}},{key:"setColumnBorder",value:function(t){var e=this;if(this.columnBorder=t,this.chartColumnContainer){var n=Array.from(this.chartColumnContainer.children);n.length>0&&n.forEach((function(t){t.style.border=e.columnBorder}))}else y("Неверный формат данных границы. Пожалуйста, укажите строковый формат.")}},{key:"setChartWidth",value:function(t){"number"==typeof t&&t>0?(this.size.width=t,this.chartContainer.innerHTML="",this.setContainerSize(),this.setChartType(this.chartType)):y("Недопустимая ширина диаграммы. Укажите положительное число.")}},{key:"setChartHeight",value:function(t){"number"==typeof t&&t>0?(this.size.height=t,this.chartContainer.innerHTML="",this.setContainerSize(),this.setChartType(this.chartType)):y("Недопустимая высота диаграммы. Пожалуйста, укажите положительное число.")}}]),t}();return e})()));